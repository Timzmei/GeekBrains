# **Туториал по GIT**
Это будет наш маленький справочник по системе контроля версий.

## Установка
Установить git очень просто:  
**Linux** — нужно просто открыть терминал и установить приложение при помощи пакетного менеджера вашего дистрибутива. Для Ubuntu команда будет выглядеть следующим образом:
```
sudo apt-get install git
```
**Windows** — рекомендуется установить [git for windows](https://git-scm.com/download/win), так как он содержит и клиент с графическим интерфейсом, и эмулятор bash.  
**OS X** — проще всего воспользоваться homebrew. После его установки запустите в терминале:
```
brew install git
```
## Настройка
После установки нужно добавить немного настроек. Самые важные: ***наше имя пользователя*** и ***адрес электронной почты***. Откройте терминал и запустите команды:
```
git config --global user.name "Мое имя"
git config --global user.email "моя@почта.ru"
```
Теперь каждое наше действие будет отмечено именем и почтой. Таким образом, пользователи всегда будут в курсе, кто отвечает за какие изменения — это вносит порядок.

## Инициализация репозитория

Чтобы инициализировать репозиторий (создать место для изменения версий файлов), используйте следующую команду:

```
git init
```
## Добавление файлов в репозиторий

Чтобы добавить файл в репозиторий, необходимо прописать следующую команду:
```
git add <название файла>
```
Чтобы добавить все файлы в директории, введите:
```
$ git add -A
```
## Создать коммит

Чтобы сохранить изменения нужно создать коммит.
Изменения в файлах добавленных с помощью команды `git add` в GIT можно зафиксировать (закоммитить), прописав команду:
```
git commit -m 'имя коммита'
```  
## Посмотреть список коммитов

Чтобы посмотреть историю коммитов, необходимо прописать следующую команду:
```
git log
```  
## Чтобы посмотреть, что нового появилось в коммите
Чтобы посмотреть, что нового появилось в коммите, мы можем воспользоваться командой:
```
git show имя_коммита
```

Вывод будет примерно таким:
```
$ git show b10cc123
commit b10cc1238e355c02a044ef9f9860811ff605c9b4
Author: Tutorialzine
Date: Mon May 30 16:30:04 2016 +0300
Added content to hello.txt
diff --git a/hello.txt b/hello.txt
index e69de29..b546a21 100644
--- a/hello.txt
+++ b/hello.txt
@@ -0,0 +1 @@
+Nice weather today, isn't it?
```

## Разница между двумя коммитами
Чтобы увидеть разницу между двумя коммитами, используется команда ***diff*** (с указанием промежутка между коммитами):
```
git diff 09bd8cc..ba25c0ff
```


## Информацию о текущем состоянии репозитория

Чтобы посмотреть в какой ветке вы находитесь, какие файлы находятся в рабочем или промежуточном каталоге, а также другую информацию, необходимо прописать следующую команду:
```
git status
```  

## Создание новой ветки

Основная ветка в каждом репозитории называется **master**. Чтобы создать еще одну ветку, используем команду:
```
git branch <имя_новой_ветки>
```
команда создаст точную копию текущей ветки

## Переключение между ветками

Чтобы переключиться на другую ветку, используем команду:
```
git checkout <имя_ветки>
```
## Слияние веток
для объединения веток (применения изменений из ветки *second* к основной версии проекта - ветка *master*), нужно ввести команду ***merge <имя_ветки>***:

```
git merge <second>
```

## Удаление ветки
Бывают ситуации, когда после слива каких-то изменений из рабочей ветки в исходную версию проекта, ее, по правилам хорошего тона, необходимо удалить, чтобы она более не мешалась в вашем коде. Сделать это можно следующей командой:
```
git branch -d имя_ветки
```

## Настройка .gitignore
В большинстве проектов есть файлы или целые директории, в которые мы не хотим (и, скорее всего, не захотим) коммитить. Мы можем удостовериться, что они случайно не попадут в ***git add -A*** при помощи файла ***.gitignore***

Создайте вручную файл под названием ***.gitignore*** и сохраните его в директорию проекта.
Внутри файла перечислите названия файлов/папок, которые нужно игнорировать, каждый с новой строки. Файл ***.gitignore*** должен быть добавлен, закоммичен и отправлен на сервер, как любой другой файл в проекте. Вот хорошие примеры файлов, которые нужно игнорировать:

* Логи
* Артефакты систем сборки
* Папки node_modules в проектах node.js
* Папки, созданные IDE, например, Netbeans или IntelliJ
* Разнообразные заметки разработчика.

Файл ***.gitignore***, исключающий все перечисленное выше, будет выглядеть так:
```
*.log
build/
node_modules/
.idea/
my_notes.txt
```
Символ слэша в конце некоторых линий означает директорию (и тот факт, что мы рекурсивно игнорируем все ее содержимое). Звездочка, как обычно, означает шаблон.

## Как исправить ошибочный комментарий к коммиту или файлы в коммите
### **Как исправить описание только последнего коммита**

Если коммит только что сделан, и он не отправлен в origin-репозитарий командой git push, то изменить описание коммита можно такой командой:
```
git commit --amend -m "Новое описание"
```
Или можно дать команду:
```
git commit --amend
```
При выполнении этой команды будет открыт текстовый редактор по-умолчанию, в котором можно будет изменить сообщение коммита. После выхода из редактора, описание коммита будет изменено. При этом будет изменена SHA-1 - сумма коммита.
Кстати, исправить можно не только описание, но и файлы и их состояние в коммите. Для этого нужно просто изменить или добавить или удалить файлы в рабочей директории, зафиксировать эти изменения в индексе (командами git add или git rm и проч.), после чего можно дать команду:
```
git commit --amend
```
в результате которой GIT возьмёт текущий индекс и сделает его снимком состояния нового коммита. Опять же, при этом будет изменена SHA-1 сумма коммита.
### **Как исправить описание любого коммита в истории**
Описанные ниже действия возможны, если коммиты еще не отправлены на удаленный репозитарий, или если программист является единственным пользователем удаленного репозитария. Описанные ниже действия являются переписыванием истории. Поэтому, если есть другие программисты, то они будут вынуждены вытянуть себе заново всю копию репозитария, чтобы у них была такая же история, что и у автора правок.  
Начиная с git 1.6.6 можно использовать механизм GIT, называющийся reword. Он используется в рамках команды `rebase`.  
Для начала находим ID коммита с неправильным комментарием. Для этого в директории с нужным git-репозиторием набираем
```
git log --pretty=format:"%h - %ar : %s"
```
На выходе получаем список коммитов с хеш-идентификаторами. Например, такой
```
39ba64e - 7 hours ago : redirect to order status after booking
c4d25d6 - 8 hours ago : order status
```
Предполагается, что надо изменить коммит ***c4d25d6***. В дальнейших командах, контрольная сумма коммита обозначает глубину, на которую будет изменяться история.
Чтобы исправить неправильный комментарий у коммита ***c4d25d6***, вводим следующую команду (обратите внимание на символ `^` после ID, это значит, что начинать **rebase** надо от его родителя. То есть, в команде **rebase** указывается родительский коммит того коммита, который надо отредактировать)
```
git rebase --interactive c4d25d6^
```
git откроет редактор по умолчанию, в котором вы увидите что-то типа:
```
pick c4d25d6 order status
pick 39ba64e redirect to order status after booking
```
Это сценарий действий, которые будут выполнены для изменения истории.
Меняем слово ***pick*** на слово ***reword***, то есть нам нужно лишь изменить комментарий.
```
reword c4d25d6 order status
pick 39ba64e redirect to order status after booking
```
GIT предложит сохранить текстовый файл, что и нужно сделать. Фактически, в интерактивном режиме, это список команд для него. Он снова откроет текстовый редактор и предложит изменить комментарий для нужного коммита. После сохранения файлика git повторит весь комит, поменяет его ID и короткий хеш. Все. Кстати, помимо ***reword*** есть еще и команда ***edit***. После сохранения файла сценария, сценарий будет выполняться до команды ***edit***, после чего GIT завершит работу и вернется в консоль. Будут примерно такие сообщения:
```
$ git rebase --interactive c4d25d6^
Stopped at c4d25d6... updated the gemspec to hopefully work better
You can amend the commit now, with
git commit --amend
Once you’re satisfied with your changes, run
git rebase --continue
```
В этот момент рабочая директория будет находиться в состоянии коммита c4d25d6. Можно изменить это состояние (изменить или добавить или удалить файлы), и дать команду:
```
git commit --amend
```
Откроется редактор, в котором можно будет изменить описание коммита. После закрытия редактора, отредактированный коммит будет изменен в истории. И можно дать следующую команду:
```
git rebase --continue
```
Эта команда будет дальше искать коммиты, которые нужно изменить, и будет снова останавливаться чтобы позволить внести изменения, до самого последнем коммите. Чтобы запушить изменения, сделанные таким способом, нужно выполнить команду:
```
git push --force
```
После нее история на origin-сервере будет перезаписана. И если с репозитарием работают другие программисты, они должны будут принять всю измененную историю. Как это сделать - надо искать отдельно. Радикальный способ - это сделать ***git clone*** в отдельной директории и продолжить работу в ней.